define(["jquery","eventDispatcher","zClip","os"],function(o,n,e,t){function i(){var n=o("html").hasClass("iOS");d.on("click",".copyIcon",function(e){var t=o(e.currentTarget).parents(".social-overlay-link-wrapper").find(".copy-text");t&&"undefined"!=typeof t&&t.select(),n&&t&&"undefined"!=typeof t&&t.get(0).setSelectionRange(0,9999);try{document.execCommand("copy")}catch(i){console.error("Oops, unable to copy")}})}function c(o){a(o).each(s)}function a(n){return!t.supportsTouch()&&t.isFlashEnabled()?o(p,n):o()}function s(){var n=o(this);n.zclip({path:f,copy:n.find(".copy-text").text(),afterCopy:function(){l(n)}})}function r(o){var n=a(o);n.data("zclipId")&&n.each(u)}function u(){o(this).zclip("remove")}function l(o){var n="_copied";clearTimeout(y),o.addClass(n),y=setTimeout(function(){o.removeClass(n)},2500)}var p='[data-module="copyLink"]',f="/_ui/responsive/common/js/libs/jquery-zclip/ZeroClipboard.swf",d=o("body"),y=null,v=o(p).closest(".social-overlay");return{load:function(){function e(){}v.on("overlay.open",function(){var n=o(this);r(n),setTimeout(function(){},600)}),v.on("overlay.close",function(){r(o(this))}),i(),n.dispatchAndListen("copyLink",e)},buildCopyLinks:c}});