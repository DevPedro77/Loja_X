function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}define(["eventDispatcher","gucciAuth","gtmUtilities"],function(a,b,c){"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function _getRequireWildcardCache(a){return a?c:b})(a)}function e(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!==_typeof(a)&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!=g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}function j(){function b(a,b,c){return Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}),a[b]}function k(b,d,e,f){var g=d&&d.prototype instanceof q?d:q,h=Object.create(g.prototype),a=new F(f||[]);return J(h,"_invoke",{value:B(b,e,a)}),h}function m(a,b,c){try{return{type:"normal",arg:a.call(b,c)}}catch(a){return{type:"throw",arg:a}}}function q(){}function w(){}function x(){}function z(a){["next","throw","return"].forEach(function(c){b(a,c,function(a){return this._invoke(c,a)})})}function A(b,d){function c(e,f,g,i){var a=m(b[e],b,f);if("throw"!==a.type){var j=a.arg,k=j.value;return k&&"object"==_typeof(k)&&t.call(k,"__await")?d.resolve(k.__await).then(function(a){c("next",a,g,i)},function(a){c("throw",a,g,i)}):d.resolve(k).then(function(a){j.value=a,g(j)},function(a){return c("throw",a,g,i)})}i(a.arg)}var e;J(this,"_invoke",{value:function value(a,b){function f(){return new d(function(d,e){c(a,b,d,e)})}return e=e?e.then(f,f):f()}})}function B(a,b,d){var e="suspendedStart";return function(f,g){if(e==="executing")throw new Error("Generator is already running");if("completed"===e){if("throw"===f)throw g;return{value:H,done:!0}}for(d.method=f,d.arg=g;;){var h=d.delegate;if(h){var i=C(h,d);if(i){if(i===s)continue;return i}}if("next"===d.method)d.sent=d._sent=d.arg;else if("throw"===d.method){if("suspendedStart"===e)throw e="completed",d.arg;d.dispatchException(d.arg)}else"return"===d.method&&d.abrupt("return",d.arg);e="executing";var j=m(a,b,d);if("normal"===j.type){if(e=d.done?"completed":"suspendedYield",j.arg===s)continue;return{value:j.arg,done:d.done}}"throw"===j.type&&(e="completed",d.method="throw",d.arg=j.arg)}}}function C(b,c){var d=c.method,e=b.iterator[d];if(e===H)return c.delegate=null,"throw"===d&&b.iterator.return&&(c.method="return",c.arg=H,C(b,c),"throw"===c.method)||"return"!==d&&(c.method="throw",c.arg=new TypeError("The iterator does not provide a '"+d+"' method")),s;var f=m(e,b.iterator,c.arg);if("throw"===f.type)return c.method="throw",c.arg=f.arg,c.delegate=null,s;var g=f.arg;return g?g.done?(c[b.resultName]=g.value,c.next=b.nextLoc,"return"!==c.method&&(c.method="next",c.arg=H),c.delegate=null,s):g:(c.method="throw",c.arg=new TypeError("iterator result is not an object"),c.delegate=null,s)}function D(a){var b={tryLoc:a[0]};1 in a&&(b.catchLoc=a[1]),2 in a&&(b.finallyLoc=a[2],b.afterLoc=a[3]),this.tryEntries.push(b)}function E(a){var b=a.completion||{};b.type="normal",delete b.arg,a.completion=b}function F(a){this.tryEntries=[{tryLoc:"root"}],a.forEach(D,this),this.reset(!0)}function G(a){if(a||""===a){var b=a[K];if(b)return b.call(a);if("function"==typeof a.next)return a;if(!isNaN(a.length)){var c=-1,d=function b(){for(;++c<a.length;)if(t.call(a,c))return b.value=a[c],b.done=!1,b;return b.value=H,b.done=!0,b};return d.next=d}}throw new TypeError(_typeof(a)+" is not iterable")}j=function _regeneratorRuntime(){return I};var H,I={},e=Object.prototype,t=e.hasOwnProperty,J=Object.defineProperty||function(a,b,c){a[b]=c.value},n="function"==typeof Symbol?Symbol:{},K=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",c=n.toStringTag||"@@toStringTag";try{b({},"")}catch(a){b=function define(a,b,c){return a[b]=c}}I.wrap=k;var i="suspendedStart",h="suspendedYield",l="executing",f="completed",s={},o={};b(o,K,function(){return this});var r=Object.getPrototypeOf,d=r&&r(r(G([])));d&&d!==e&&t.call(d,K)&&(o=d);var u=x.prototype=q.prototype=Object.create(o);return w.prototype=x,J(u,"constructor",{value:x,configurable:!0}),J(x,"constructor",{value:w,configurable:!0}),w.displayName=b(x,c,"GeneratorFunction"),I.isGeneratorFunction=function(a){var b="function"==typeof a&&a.constructor;return!!b&&(b===w||"GeneratorFunction"===(b.displayName||b.name))},I.mark=function(a){return Object.setPrototypeOf?Object.setPrototypeOf(a,x):(a.__proto__=x,b(a,c,"GeneratorFunction")),a.prototype=Object.create(u),a},I.awrap=function(a){return{__await:a}},z(A.prototype),b(A.prototype,a,function(){return this}),I.AsyncIterator=A,I.async=function(b,c,d,e,f){void 0===f&&(f=Promise);var g=new A(k(b,c,d,e),f);return I.isGeneratorFunction(c)?g:g.next().then(function(a){return a.done?a.value:g.next()})},z(u),b(u,c,"Generator"),b(u,K,function(){return this}),b(u,"toString",function(){return"[object Generator]"}),I.keys=function(a){var b=Object(a),c=[];for(var d in b)c.push(d);return c.reverse(),function a(){for(;c.length;){var d=c.pop();if(d in b)return a.value=d,a.done=!1,a}return a.done=!0,a}},I.values=G,F.prototype={constructor:F,reset:function reset(a){if(this.prev=0,this.next=0,this.sent=this._sent=H,this.done=!1,this.delegate=null,this.method="next",this.arg=H,this.tryEntries.forEach(E),!a)for(var b in this)"t"===b.charAt(0)&&t.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=H)},stop:function stop(){this.done=!0;var a=this.tryEntries[0].completion;if("throw"===a.type)throw a.arg;return this.rval},dispatchException:function dispatchException(b){function d(a,c){return h.type="throw",h.arg=b,e.next=a,c&&(e.method="next",e.arg=H),!!c}if(this.done)throw b;for(var e=this,f=this.tryEntries.length-1;0<=f;--f){var g=this.tryEntries[f],h=g.completion;if("root"===g.tryLoc)return d("end");if(g.tryLoc<=this.prev){var j=t.call(g,"catchLoc"),k=t.call(g,"finallyLoc");if(j&&k){if(this.prev<g.catchLoc)return d(g.catchLoc,!0);if(this.prev<g.finallyLoc)return d(g.finallyLoc)}else if(!j){if(!k)throw new Error("try statement without catch or finally");if(this.prev<g.finallyLoc)return d(g.finallyLoc)}else if(this.prev<g.catchLoc)return d(g.catchLoc,!0)}}},abrupt:function abrupt(b,c){for(var d,e=this.tryEntries.length-1;0<=e;--e)if(d=this.tryEntries[e],d.tryLoc<=this.prev&&t.call(d,"finallyLoc")&&this.prev<d.finallyLoc){var f=d;break}f&&("break"===b||"continue"===b)&&f.tryLoc<=c&&c<=f.finallyLoc&&(f=null);var g=f?f.completion:{};return g.type=b,g.arg=c,f?(this.method="next",this.next=f.finallyLoc,s):this.complete(g)},complete:function complete(a,b){if("throw"===a.type)throw a.arg;return"break"===a.type||"continue"===a.type?this.next=a.arg:"return"===a.type?(this.rval=this.arg=a.arg,this.method="return",this.next="end"):"normal"===a.type&&b&&(this.next=b),s},finish:function finish(a){for(var b,c=this.tryEntries.length-1;0<=c;--c)if(b=this.tryEntries[c],b.finallyLoc===a)return this.complete(b.completion,b.afterLoc),E(b),s},catch:function _catch(a){for(var b,c=this.tryEntries.length-1;0<=c;--c)if(b=this.tryEntries[c],b.tryLoc===a){var d=b.completion;if("throw"===d.type){var f=d.arg;E(b)}return f}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(a,b,c){return this.delegate={iterator:G(a),resultName:b,nextLoc:c},"next"===this.method&&(this.arg=H),s}},I}function k(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function l(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){function f(a){k(h,d,e,f,g,"next",a)}function g(a){k(h,d,e,f,g,"throw",a)}var h=a.apply(b,c);f(void 0)})}}/* global Modernizr */a=e(a);var m="data-binded",n=function hasEventsAttached(a){return"true"===a.getAttribute(m)},o=function getAppGroups(){var a=Array.from(document.querySelectorAll("[data-app=group]"));return a.filter(function(a){return!n(a)})},p=/*#__PURE__*/function(){var a=l(/*#__PURE__*/j().mark(function a(){var c,d,e,f;return j().wrap(function g(a){for(;1;)switch(a.prev=a.next){case 0:return c=document.getElementById("gucciAppAdv"),a.next=3,(0,b.getAccessToken)();case 3:d=a.sent,c&&d&&(e=c.content.cloneNode(!0),e.querySelector("div").setAttribute("data-analyticsLabel","navigation"),f=document.querySelector(".item-secondary.create-account-item"),f&&f.parentNode.insertBefore(e,f.nextSibling));case 5:case"end":return a.stop()}},a)}));return function addAppAdvToMobileMenu(){return a.apply(this,arguments)}}(),q=function attachMobileHandlers(a){var b=document.querySelector("html"),c=b.classList.contains("android"),d=Modernizr.ios,f=document.querySelector("#gucciAndroidAppLink").getAttribute("value"),g=document.querySelector("#gucciIOsAppLink").getAttribute("value");(c||d)&&a.forEach(function(a){var b=a.querySelector("[data-app=trigger]");b.setAttribute("role","link"),b.removeAttribute("aria-expanded"),b.removeAttribute("aria-controls"),b.addEventListener("click",function(a){a.preventDefault();var b=c?f:g;window.open(b,"_blank")})})},r=function closeAppLinks(a,b,c){b.setAttribute("aria-expanded","false"),b.classList.remove("active"),c.classList.remove("active")},s=function attachUIHandlers(a){a.forEach(function(a){var b=a.querySelector("[data-app=trigger]"),c=a.querySelector("[data-app=links]");if(b&&c){var d=function handleGroup(){b.setAttribute("aria-expanded","true"),b.classList.add("active"),c.classList.add("active")};a.addEventListener("mouseenter",d),a.addEventListener("click",d),a.addEventListener("mouseleave",function(){return r(a,b,c)}),c.addEventListener("blur",function(){return r(a,b,c)})}})},t=function attachAnalytics(a){a.forEach(function(a){var b=a.dataset.analyticslabel;a.addEventListener("click",function(){// Event Category: app banner
// Event Action: banner shown
// Event Label: thank you page / navigation / etc.
// Event type: Non-interaction event
// Event Category: app banner
// Event Action: click on banner
// Event Label: thank you page / navigation / etc.
// Event type: Interaction event
(0,c.ga4SendGenericEvent)("gucciapp.appbanner.click",{label:b}),(0,c.safeGTMuaEventsPusher)("interactionEvent","app banner","click on app banner",b)});var d=new IntersectionObserver(function(a){!0===a[0].isIntersecting&&((0,c.ga4SendGenericEvent)("gucciapp.appbanner.show",{label:b}),(0,c.safeGTMuaEventsPusher)("nonInteractionEvent","app banner","app banner shown",b),this.disconnect())},{threshold:[0]});d.observe(a)})},u=function attachPopupEvent(a){a.forEach(function(a){var b=a.querySelector("[data-app=closePopup]");b&&b.addEventListener("click",function(){document.body.classList.add("app-adv_orderconfirmation-closed"),a.classList.add("app-adv_closed")})})},v=function attachHandlers(){var a=o();q(a),s(a),t(a),u(a),a.forEach(function(a){return a.setAttribute(m,"true")})},w=function handleHeaderAccount(){a.handleLoadedModules("headerMenuMobileAccount",function(){v()})},x=function initGucciApp(){p(),v(),w()};"complete"===document.readyState||"loaded"===document.readyState||"interactive"===document.readyState?x():window.addEventListener("DOMContentLoaded",x)});
//# sourceMappingURL=gucciapp.js.map
